(function(n,t){"use strict";function r(n){for(var i=new ArrayBuffer(n.length*2),r=new Uint16Array(i),t=0,u=n.length;t<u;t++)r[t]=n.charCodeAt(t);return i}var i=t.define("App.ajax.file");i.upload=function(n,i){var u=t.isArray(i)?i:[i],r=new FormData;return Array.prototype.forEach.call(u,function(n,t){r.append(t,n)}),{url:n,type:"POST",cache:!1,processData:!1,contentType:!1,dataType:"binary",responseType:"binary",data:r,converters:{"json binary":function(n){return JSON.parse(n)}}}};i.download=function(n,i,r){var u=t.isUndefOrNull(r)?"GET":r;return{url:n,type:u,cache:!1,contentType:"application/json; charset=utf-8",data:u=="GET"?i:JSON.stringify(i),dataType:"binary"}};n.ajaxTransport("binary",function(n,i,u){return{send:function(i,f){var e=new XMLHttpRequest,o;e.addEventListener("load",function(){var s=e.getResponseHeader("content-type")||"",h=e.getResponseHeader("Content-Disposition")||"",c=e.response?Object.prototype.toString.call(e.response):"",i,o;if(c==="[object Blob]"){if((e.response.type||"").toUpperCase().indexOf("APPLICATION/JSON")===0){i=new FileReader;i.addEventListener("loadend",function(){u.responseType="json";u.responseJSON=JSON.parse(i.result);u.responseText=i.result;e.status>=400?f(e.status,e.statusText,{},e.getAllResponseHeaders()):f(e.status,e.statusText,{json:u.responseText},e.getAllResponseHeaders())});i.readAsText(e.response);return}if(e.status>=400){u.responseType="blob";u.response=e.response;f(e.status,e.statusText,{},e.getAllResponseHeaders());return}o={};o[n.dataType]=e.response;f(e.status,e.statusText,o,e.getAllResponseHeaders());return}if(t.isStr(e.response)&&h.toUpperCase().indexOf("ATTACHMENT;")===0){u.response=new Blob([r(e.response)],{type:s});u.responseType="blob";f(e.status,e.statusText,{},e.getAllResponseHeaders());return}o[n.dataType]=e.response;f(e.status,e.statusText,o,e.getAllResponseHeaders())});e.open(n.type,n.url,n.async||!0);for(o in i)e.setRequestHeader(o,i[o]);e.responseType="blob";e.send(n.data||null)},abort:function(){u.abort()}}});i.extractFileNameDownload=function(n){var r="",i=n.getResponseHeader("Content-Disposition"),u,t;return i&&i.indexOf("attachment")!==-1&&(u=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,t=u.exec(i),t!=null&&t[1]&&(r=decodeURIComponent(t[1].replace(/['"]/g,"")))),r}})(jQuery,App);
/*
//# sourceMappingURL=app.ajax.file.min.js.map
*/