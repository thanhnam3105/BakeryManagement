# 同時実行排他制御検知ツール

2017/09/01 kaneko.m

## 概要

EDMXのエンティティの同時実行排他制御の状況を調べるためのツールです。  
コンソール上に一覧を出力します。

## 実行方法

コマンドプロンプト上で実行してください。

``` cmd
ConcurrencyDetector [-i][-c]

-i EDMXファイルのパス（ディレクトリ指定可能）
-c 同時実行制御を検知するカラム名（指定しない場合、全てのカラム名を対象）
```

## VisualStudioでのビルド前チェックツールとしての利用

### 説明

* このツールは同時実行排他制御がかかっていないカラムがある場合には`終了コード=「1」`で終了します。

* VisualStudioのビルド前のコマンドライン実行機能では、`終了コード=「0」`以外で終了していると  
ビルドを実行しないように設定ができるので、ビルド前のチェックツールとして利用できます。

* 実行結果は「出力」ウインドウに出力されます。

### セットアップ方法

* プロジェクトの`「プロパティ」→「ビルド イベント」→「ビルド前に実行するコマンドライン」`内に、設定を記述してください。

#### 設定例

`[.slnファイルと同じフォルダ]\ConcurrencyDetector`にツールを配置し、「ts」列を対象に検知をする場合  

``` cmd
$(ProjectDir)..\ConcurrencyDetector\ConcurrencyDetector -i $(ProjectDir)Data -c ts
```

##### 追記

* `$(ProjectDir)`変数には`*.csproj`ファイルのパスが指定されます
* `*.csproj`ファイル起点でのパス指定をしてないと、自動ビルド時にエラーとなります

## TODO（できたらいいな）

* 結果をテキストファイルで出力するオプションの追加
* ログ出力機能追加