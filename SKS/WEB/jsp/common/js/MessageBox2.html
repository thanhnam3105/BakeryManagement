<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <STYLE>
    BODY,TABLE {font-size: 11pt;}
  </STYLE>

<SCRIPT language="JScript">
    var msg  = window.dialogArguments[0];
//    msg = msg.replace(/\\n/,"<br>");
//MOD 2013/06/28 ogawa 【QP@30151】No.38 start
//修正前ソース
//    msg = msg.split(/\\n/).join("<br>");
//修正後ソース(タブがあればメッセージを2つに分ける)
var d1=0,d2=0;
    msg = msg.split(/\\t/);
    var msg1 = msg[0].split(/\\n/).join("<br>");
    if(msg.length > 1){
        var msg2 = msg[1].split(/\\n/).join("<br>");
    }
//MOD 2013/06/28 ogawa 【QP@30151】No.38 end
    var mark = window.dialogArguments[1];
    var title = window.dialogArguments[2];
    var btn = new Array(3);
    btn[0] = window.dialogArguments[3];
    btn[1] = window.dialogArguments[4];
    btn[2] = window.dialogArguments[5];

    var dw = 0;
//MOD 2013/06/28 ogawa 【QP@30151】No.38 start
//修正前ソース
//    var arrMsg = msg.split("<br>");
//    for (var i=0;i<arrMsg.length;i++){
//      var len = (getLength(arrMsg[i]) * 12 + 40 );
//      if (dw<len) dw = len;
//    }
//    if (dw < 350) dw=350 
//    if (dw > 700) dw=700;
//
//修正後ソース（一番長い行を求める)
    var arrMsg = msg1.split("<br>");
    for (var i=0;i<arrMsg.length;i++){
       var len = arrMsg[i].length;
      if (dw<len){
    	  dw = len;
    	  d1=1;
    	  d2=i;
       }
    }
    if(msg.length > 1){
      var arrMsg2 = msg2.split("<br>");
      for (var i=0;i<arrMsg2.length;i++){
      var len = arrMsg2[i].length;
      if (dw<len){
    	  dw = len;
    	  d1=2;
    	  d2=i;
       }
      }
    }
//MOD 2013/06/28 ogawa 【QP@30151】No.38 end
//MOD 2013/06/28 ogawa 【QP@30151】No.38 start
//修正前ソース
//    var dh = arrMsg.length * 12 + 120 + 10 ;
//修正後ソース（行数の合計により、dialogHeightを決定する）
    if(msg.length > 1){
      var dh = (arrMsg.length + arrMsg2.length) * 12 + 120 + 10 ;
    }else{
      var dh = arrMsg.length * 12 + 120 + 10 ;
    }
//MOD 2013/06/28 ogawa 【QP@30151】No.38 end

    //バージョンの取得
    var userAgentStr = navigator.userAgent;
    var msieIndex = userAgentStr.indexOf("MSIE");

    //"MSIE 6.0" ,"MSIE 7.0" バージョンの前にスペースあり
    var version = userAgentStr.substring(msieIndex+5, userAgentStr.indexOf(".", msieIndex));

    if (version == 7) { //IE7サイズ調整
      dh = dh - 25;
    }

    window.dialogHeight=dh + "px"; 

    document.title=title;

function getLength(str) {
  var i, count = 0;

  for (i = 0; i < str.length; i++) {
     if(escape(str.charAt(i)).length > 1) count++;
     count++;
  }
  return count;
}

function fnOnloadBody() {
  var btnHTML="";
  var i;

  simg.innerHTML = '<img src="../../image/' + mark + '.png">';
//DEL 2013/06/28 ogawa 【QP@30151】No.38 start
//  MsgStr.innerHTML = msg;
//DEL 2013/06/28 ogawa 【QP@30151】No.38 end

  for(i=0; i<3; i++) {
    switch(btn[i]) {
    case "yes":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'yes'"+')" id="sbtn'+ i +'">はい</button>';
       break;
    case "no":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'no'"+')" id="sbtn'+ i +'">いいえ</button>';
    break;
    case "close":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'close'"+')" id="sbtn'+ i +'">閉じる</button>';
    break;
    case "cancel":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'cancel'"+')" id="sbtn'+ i +'">キャンセル</button>';
    break;
    case "abort":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'abort'"+')" id="sbtn'+ i +'">中止</button>';
    break;
    }
  }

  sbtn.innerHTML = btnHTML;
  sbtn0.focus();
//MOD 2013/06/28 ogawa 【QP@30151】No.38 start
//修正前ソース
//    var arrMsg = msg.split("<br>");
//    for (var i=0;i<arrMsg.length;i++){
//      var len = (getLength(arrMsg[i]) * 12 + 40 );
//      if (dw<len) dw = len;
//    }
//    if (dw < 350) dw=350 
//    if (dw > 700) dw=700;
//
//修正後ソース（一番長い行で、dialogWidthの設定を行う)
    if(d1 == 1){
   	 MsgStr.innerHTML = arrMsg[d2];
    }else if(d1 == 2){
        MsgStr.innerHTML = arrMsg2[d2];
    }
     window.dialogWidth=MsgStr.offsetWidth+155+"px";
//(メッセージを設定する)
     MsgStr.innerHTML = msg1;
     if(msg.length > 1){
       MsgStr2.innerHTML = "<br>" + msg2;
     }
//MOD 2013/06/28 ogawa 【QP@30151】No.38 end
  // window.dialogWidth=MsgStr.offsetWidth+150+"px";
}

function btnClick(str) {
  window.returnValue=str;
  self.close();
}

//ENTER->TAB変換
function _body_onkeydown() {
    switch(event.keyCode) {
     case 39:  //RightArrow=39なら
       event.keyCode = 0x9;
       break;
    }

    return;
}
  </SCRIPT>
</head>

<body bgcolor="ButtonFace" onLoad="fnOnloadBody();" onkeydown="_body_onkeydown()">

  <table border="0" cellpadding="15">
  <tr>
    <td width="30"><SPAN id="simg"></SPAN></td>
<!-- MOD 2013/06/28 ogawa 【QP@30151】No.38 start -->
<!-- 修正前ソース -->
<!--     <td width="100%"><SPAN id="MsgStr"></SPAN>  -->
<!-- 修正後ソース -->
    <td width="100%"><SPAN id="MsgStr"></SPAN><SPAN style="color:red" id="MsgStr2"></SPAN>
<!--MOD 2013/06/28 ogawa 【QP@30151】No.38 start -->
    </td>
  </tr>
  </table>
  <table width="100%">
  <tr>
    <td align="center"> 
    <SPAN id="sbtn"></SPAN>
    </td>
  </tr>
  </table>

</body>

</html>
