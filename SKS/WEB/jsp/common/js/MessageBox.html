<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <STYLE>
    BODY,TABLE {font-size: 11pt;}
  </STYLE>

<SCRIPT language="JScript">
    var msg  = window.dialogArguments[0];
//    msg = msg.replace(/\\n/,"<br>");
// MOD 2015/05/15 TT.Kitazawa【QP@40812】No.6 start
//    msg = msg.split(/\\n/).join("<br>");
    var msgary = msg.split(/\\t/);
    msg = msgary[0].split(/\\n/).join("<br>");
    if(msgary.length > 1){
        var msg2 = msgary[1].split(/\\n/).join("<br>");
    }
 // MOD 2015/05/15 TT.Kitazawa【QP@40812】No.6 end
    var mark = window.dialogArguments[1];
    var title = window.dialogArguments[2];
    var btn = new Array(3);
    btn[0] = window.dialogArguments[3];
    btn[1] = window.dialogArguments[4];
    btn[2] = window.dialogArguments[5];

    var dw = 0;
    var arrMsg = msg.split("<br>");
    for (var i=0;i<arrMsg.length;i++){
      var len = (getLength(arrMsg[i]) * 12 + 40 );
      if (dw<len) dw = len;
    }


    if (dw < 350) dw=350
    if (dw > 700) dw=700;

    var dh = arrMsg.length * 12 + 120 + 10 ;

    //バージョンの取得
    var userAgentStr = navigator.userAgent;
    var msieIndex = userAgentStr.indexOf("MSIE");

    //"MSIE 6.0" ,"MSIE 7.0" バージョンの前にスペースあり
    var version = userAgentStr.substring(msieIndex+5, userAgentStr.indexOf(".", msieIndex));

    if (version == 7) { //IE7サイズ調整
      dh = dh - 25;
    }

    window.dialogHeight=dh + "px";

    // ADD 2015/2/20 TT.Kitazawa【H26年度改良】
    window.dialogWidth =dw + "px";
 //   window.dialogLeft = (screen.width - dw) / 2 + "px";
    // ADD 2015/2/20 TT.Kitazawa【H26年度改良】

    document.title=title;

function getLength(str) {
  var i, count = 0;

  for (i = 0; i < str.length; i++) {
     if(escape(str.charAt(i)).length > 1) count++;
     count++;
  }
  return count;
}

function fnOnloadBody() {
  var btnHTML="";
  var i;

  simg.innerHTML = '<img src="../../image/' + mark + '.png">';
  MsgStr.innerHTML = msg;

  for(i=0; i<3; i++) {
    switch(btn[i]) {
    case "yes":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'yes'"+')" id="sbtn'+ i +'">はい</button>';
       break;
    case "no":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'no'"+')" id="sbtn'+ i +'">いいえ</button>';
    break;
    case "close":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'close'"+')" id="sbtn'+ i +'">閉じる</button>';
    break;
    case "cancel":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'cancel'"+')" id="sbtn'+ i +'">キャンセル</button>';
    break;
    case "abort":
       btnHTML = btnHTML +'<button style="width:70px;margin-left:5px;" onclick="btnClick(' + "'abort'"+')" id="sbtn'+ i +'">中止</button>';
    break;
    }
  }

  sbtn.innerHTML = btnHTML;
  sbtn0.focus();

 // window.dialogWidth=MsgStr.offsetWidth+150+"px";
}

function btnClick(str) {
  window.returnValue=str;
  self.close();
}

//ENTER->TAB変換
function _body_onkeydown() {
    switch(event.keyCode) {
     case 39:  //RightArrow=39なら
       event.keyCode = 0x9;
       break;
    }

    return;
}
  </SCRIPT>
</head>

<body bgcolor="ButtonFace" onLoad="fnOnloadBody();" onkeydown="_body_onkeydown()">

  <table border="0" cellpadding="15">
  <tr>
    <td width="30"><SPAN id="simg"></SPAN></td>
    <td width="100%"><SPAN id="MsgStr"></SPAN>
    </td>
  </tr>
  </table>
  <table width="100%">
  <tr>
    <td align="center">
    <SPAN id="sbtn"></SPAN>
    </td>
  </tr>
  </table>

</body>

</html>
